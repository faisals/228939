{% extends "base.html" %}
{% block content %}
<div class="container mx-auto p-8">
    <h1 class="text-4xl font-extrabold mb-8 text-center text-blue-600">LeetCoder Dashboard</h1>
    
    <div class="flex flex-wrap -mx-4">
        <!-- Problems List Column -->
        <div class="w-full lg:w-2/3 px-4 mb-8 lg:mb-0">
            <div class="bg-white shadow-lg rounded-lg p-8">
                <h2 class="text-2xl font-semibold mb-6 text-gray-800">LeetCoder Problems</h2>

                <!-- Problems Table -->
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white border border-gray-200 rounded-lg">
                        <thead class="bg-blue-100">
                            <tr>
                                <th class="py-3 px-4 border-b text-left">Title</th>
                                <th class="py-3 px-4 border-b text-left">Difficulty</th>
                                <th class="py-3 px-4 border-b text-left">Status</th>
                                <th class="py-3 px-4 border-b text-left">Last Attempt</th>
                                <th class="py-3 px-4 border-b text-left">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for problem in problems %}
                            <tr class="hover:bg-gray-50">
                                <td class="py-3 px-4 border-b"><a href="{{ url_for('problem_details', problem_id=problem[0]) }}" class="text-blue-500 hover:underline">{{ problem[2] }}</a></td>
                                <td class="py-3 px-4 border-b">
                                    <span class="
                                        {% if problem[3] == 'Easy' %}
                                            text-green-500
                                        {% elif problem[3] == 'Medium' %}
                                            text-yellow-500
                                        {% else %}
                                            text-red-500
                                        {% endif %}
                                    ">{{ problem[3] }}</span>
                                </td>
                                <td class="py-3 px-4 border-b">{{ problem[5] }}</td>
                                <td class="py-3 px-4 border-b">{{ problem[4] | format_date }}</td>
                                <td class="py-3 px-4 border-b">
                                    <a href="{{ url_for('problem_details', problem_id=problem[0]) }}" class="text-blue-500 hover:underline">View</a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Progress Summary Column -->
        <div class="w-full lg:w-1/3 px-4">
            <div class="bg-white shadow-lg rounded-lg p-8">
                <h2 class="text-2xl font-semibold mb-6 text-gray-800">Progress Summary</h2>
                
                <!-- Overall Statistics -->
                <div class="mb-8">
                    <h3 class="text-lg font-medium mb-4">Overall Statistics</h3>
                    <p class="mb-2">Total Problems: <span class="font-semibold">{{ total_problems }}</span></p>
                    <p class="mb-2">Completed Problems: <span class="font-semibold">{{ completed_problems }}</span></p>
                    <p>Completion Rate: <span class="font-semibold">{{ (completed_problems / total_problems * 100) | round(2) }}%</span></p>
                </div>

                <!-- Weekly Progress -->
                <div class="mb-8">
                    <h3 class="text-lg font-medium mb-4">This Week's Progress</h3>
                    <p class="mb-2">Problems Worked On: <span class="font-semibold">{{ total_worked }}</span></p>
                    <p>Problems Completed: <span class="font-semibold">{{ total_completed }}</span></p>
                </div>

                <!-- Daily Progress Chart (placeholder) -->
                <div>
                    <h3 class="text-lg font-medium mb-4">Daily Progress (Last 7 Days)</h3>
                    <!-- You could add a simple bar chart here using CSS or a JavaScript charting library -->
                    <div class="flex items-end space-x-2 h-40">
                        {% for day in daily_progress %}
                        <div class="bg-blue-500 w-10" style="height: {{ day[2] * 10 }}%;" title="{{ day[2] }} problems">{{ day[2] }}</div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Add Form -->
    <div class="mt-8">
        <form id="quickAddForm" method="POST" action="{{ url_for('quick_add_problem') }}" class="bg-white shadow-lg rounded-lg p-8">
            <h2 class="text-xl font-semibold mb-6 text-gray-800">Quick Add Problem</h2>
            <input type="text" name="url" placeholder="Enter LeetCode problem URL" required
                   class="shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mb-4">
            <button type="submit" class="w-full bg-blue-500 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded focus:outline-none focus:shadow-outline">
                Add Problem
            </button>
        </form>
    </div>
</div>
{% endblock %}
